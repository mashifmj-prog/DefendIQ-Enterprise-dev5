<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DefendIQ Enterprise | AI Security Intelligence</title>
    <meta name="theme-color" content="#1a237e">
    <meta name="description" content="DefendIQ Enterprise - Advanced AI Security Assistant with Predictive Intelligence">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a237e;
            --primary-light: #534bae;
            --primary-dark: #000051;
            --secondary: #00b0ff;
            --accent: #ff4081;
            --ai-primary: #7e57c2;
            --ai-secondary: #b388ff;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --light: #f5f5f5;
            --dark: #212121;
            --gray: #9e9e9e;
            --bg-color: #f0f2f5;
            --text-color: #212121;
            --card-bg: white;
            --sidebar-bg: linear-gradient(to bottom, var(--primary), var(--primary-dark));
            --header-bg: white;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #f5f5f5;
            --card-bg: #1e1e1e;
            --sidebar-bg: linear-gradient(to bottom, #0d0d3d, #000022);
            --header-bg: #2d2d2d;
            --light: #2d2d2d;
            --gray: #aaaaaa;
            --dark: #f5f5f5;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar */
        .sidebar {
            width: 250px;
            background: var(--sidebar-bg);
            color: white;
            padding: 20px 0;
            transition: all 0.3s;
        }
        
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }
        
        .logo-icon {
            font-size: 32px;
            margin-right: 10px;
        }
        
        .logo-text {
            font-size: 20px;
            font-weight: 700;
        }
        
        .logo-iq {
            color: var(--secondary);
        }
        
        .sidebar-menu {
            list-style: none;
            padding: 20px 0;
        }
        
        .sidebar-menu li {
            padding: 10px 20px;
            transition: all 0.3s;
        }
        
        .sidebar-menu li.active {
            background-color: rgba(255,255,255,0.1);
            border-left: 4px solid var(--secondary);
        }
        
        .sidebar-menu li:hover {
            background-color: rgba(255,255,255,0.05);
        }
        
        .sidebar-menu a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .sidebar-menu i {
            margin-right: 10px;
            font-size: 18px;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            padding: 20px;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px 20px;
            background: var(--header-bg);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }
        
        /* AI Intelligence Dashboard */
        .ai-dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .ai-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .ai-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .ai-card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .ai-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--ai-primary), var(--ai-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }
        
        /* Enhanced ZaraAI Chat Interface */
        .zara-ai-enhanced {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
            margin-bottom: 30px;
            border: 1px solid var(--light);
        }
        
        .zara-header-enhanced {
            background: linear-gradient(to right, var(--ai-primary), var(--ai-secondary));
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .zara-identity {
            display: flex;
            align-items: center;
        }
        
        .zara-avatar-enhanced {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: white;
            color: var(--ai-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
            font-size: 24px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .zara-info h3 {
            margin-bottom: 5px;
            font-size: 20px;
        }
        
        .zara-info p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .zara-capabilities {
            display: flex;
            gap: 10px;
        }
        
        .capability-tag {
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .zara-chat-enhanced {
            height: 400px;
            padding: 20px;
            overflow-y: auto;
            border-bottom: 1px solid var(--light);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message-enhanced {
            display: flex;
            max-width: 85%;
        }
        
        .message-enhanced.user {
            align-self: flex-end;
        }
        
        .message-enhanced.zara {
            align-self: flex-start;
        }
        
        .message-content-enhanced {
            padding: 15px;
            border-radius: 18px;
            word-wrap: break-word;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .message-enhanced.zara .message-content-enhanced {
            background-color: var(--light);
            border-top-left-radius: 5px;
            border-bottom-left-radius: 18px;
            border-bottom-right-radius: 18px;
        }
        
        .message-enhanced.user .message-content-enhanced {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-top-right-radius: 5px;
            border-bottom-left-radius: 18px;
            border-bottom-right-radius: 18px;
        }
        
        .message-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .message-action {
            background: rgba(255,255,255,0.2);
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            color: inherit;
            transition: all 0.3s;
        }
        
        .message-action:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .zara-input-enhanced {
            display: flex;
            padding: 20px;
            background-color: var(--light);
            gap: 10px;
        }
        
        .zara-input-enhanced input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--light);
            border-radius: 24px;
            outline: none;
            font-size: 16px;
            background: var(--card-bg);
            color: var(--text-color);
        }
        
        .zara-input-actions {
            display: flex;
            gap: 10px;
        }
        
        .input-action-btn {
            background-color: var(--ai-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }
        
        .input-action-btn:hover {
            background-color: var(--ai-secondary);
        }
        
        /* Predictive Intelligence Panel */
        .predictive-panel {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        
        .predictive-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .predictive-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .threat-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .threat-indicator {
            background: var(--light);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .threat-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .threat-label {
            font-size: 14px;
            color: var(--gray);
        }
        
        .threat-trend {
            font-size: 12px;
            margin-top: 5px;
        }
        
        .positive {
            color: var(--success);
        }
        
        .negative {
            color: var(--danger);
        }
        
        .neutral {
            color: var(--warning);
        }
        
        /* NLP Analysis Display */
        .nlp-analysis {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        
        .analysis-result {
            background: var(--light);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .analysis-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .analysis-item:last-child {
            border-bottom: none;
        }
        
        .analysis-label {
            font-weight: 500;
        }
        
        .analysis-value {
            color: var(--primary);
            font-weight: 600;
        }
        
        /* AI Model Status */
        .ai-status {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .status-active {
            background: var(--success);
        }
        
        .status-learning {
            background: var(--warning);
        }
        
        .status-idle {
            background: var(--gray);
        }
        
        /* Voice Recognition Styles */
        .voice-listening {
            animation: pulse 1.5s infinite;
            background-color: var(--danger) !important;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .ai-dashboard {
                grid-template-columns: 1fr;
            }
            
            .zara-header-enhanced {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .zara-capabilities {
                flex-wrap: wrap;
            }
            
            .message-enhanced {
                max-width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">üõ°Ô∏è</div>
                    <div class="logo-text">Defend<span class="logo-iq">IQ</span> Enterprise</div>
                </div>
                <div>ZaraAI Enhanced v5.0</div>
            </div>
            <ul class="sidebar-menu">
                <li class="active"><a href="#"><i class="fas fa-home"></i> <span>AI Dashboard</span></a></li>
                <li><a href="#"><i class="fas fa-brain"></i> <span>Threat Intelligence</span></a></li>
                <li><a href="#"><i class="fas fa-chart-bar"></i> <span>Predictive Analytics</span></a></li>
                <li><a href="#"><i class="fas fa-robot"></i> <span>AI Models</span></a></li>
                <li><a href="#"><i class="fas fa-shield-alt"></i> <span>Security Controls</span></a></li>
                <li><a href="#"><i class="fas fa-graduation-cap"></i> <span>Training</span></a></li>
                <li><a href="#"><i class="fas fa-cog"></i> <span>AI Settings</span></a></li>
            </ul>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <div class="page-title">ZaraAI Enhanced - Security Intelligence Platform</div>
                <div class="header-actions">
                    <button class="btn btn-primary" id="refresh-ai">
                        <i class="fas fa-sync-alt"></i> Refresh AI
                    </button>
                    <div class="user-info">
                        <div class="user-avatar">AI</div>
                        <div>Admin User</div>
                    </div>
                </div>
            </div>
            
            <!-- AI Intelligence Dashboard -->
            <div class="ai-dashboard">
                <div class="ai-card">
                    <div class="ai-card-header">
                        <div class="ai-card-title">NLP Processing</div>
                        <div class="ai-card-icon">
                            <i class="fas fa-language"></i>
                        </div>
                    </div>
                    <div class="ai-status">
                        <div class="status-item">
                            <div class="status-dot status-active"></div>
                            <span>Intent Recognition: Active</span>
                        </div>
                        <div class="status-item">
                            <div class="status-dot status-learning"></div>
                            <span>Entity Extraction: Learning</span>
                        </div>
                    </div>
                </div>
                
                <div class="ai-card">
                    <div class="ai-card-header">
                        <div class="ai-card-title">Threat Prediction</div>
                        <div class="ai-card-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="ai-status">
                        <div class="status-item">
                            <div class="status-dot status-active"></div>
                            <span>Risk Assessment: Active</span>
                        </div>
                        <div class="status-item">
                            <div class="status-dot status-active"></div>
                            <span>Anomaly Detection: Active</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Enhanced ZaraAI Chat Interface -->
            <div class="zara-ai-enhanced">
                <div class="zara-header-enhanced">
                    <div class="zara-identity">
                        <div class="zara-avatar-enhanced">Z</div>
                        <div class="zara-info">
                            <h3>ZaraAI Enhanced</h3>
                            <p>Advanced NLP Security Assistant with Predictive Intelligence</p>
                        </div>
                    </div>
                    <div class="zara-capabilities">
                        <div class="capability-tag">NLP Processing</div>
                        <div class="capability-tag">Threat Prediction</div>
                        <div class="capability-tag">Risk Analysis</div>
                        <div class="capability-tag">Compliance Check</div>
                    </div>
                </div>
                
                <div class="zara-chat-enhanced" id="chat-messages">
                    <div class="message-enhanced zara">
                        <div class="message-content-enhanced">
                            <strong>Hello! I'm ZaraAI Enhanced.</strong><br><br>
                            I now feature advanced natural language processing and predictive threat intelligence capabilities. I can help you with:<br><br>
                            ‚Ä¢ <strong>Security Risk Assessment</strong> - Analyze your current security posture<br>
                            ‚Ä¢ <strong>Threat Prediction</strong> - Identify potential security threats before they occur<br>
                            ‚Ä¢ <strong>Compliance Guidance</strong> - Provide real-time compliance recommendations<br>
                            ‚Ä¢ <strong>Incident Response</strong> - Guide you through security incident procedures<br><br>
                            How can I assist with your security needs today?
                            <div class="message-actions">
                                <button class="message-action" onclick="quickAction('risk_assessment')">
                                    <i class="fas fa-shield-alt"></i> Risk Assessment
                                </button>
                                <button class="message-action" onclick="quickAction('threat_analysis')">
                                    <i class="fas fa-bug"></i> Threat Analysis
                                </button>
                                <button class="message-action" onclick="quickAction('compliance_check')">
                                    <i class="fas fa-clipboard-check"></i> Compliance Check
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="zara-input-enhanced">
                    <input type="text" id="user-input" placeholder="Ask about security risks, compliance, or threat intelligence...">
                    <div class="zara-input-actions">
                        <button class="input-action-btn" id="send-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                        <button class="input-action-btn" id="voice-btn">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button class="input-action-btn" id="analyze-btn">
                            <i class="fas fa-brain"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Predictive Intelligence Panel -->
            <div class="predictive-panel">
                <div class="predictive-header">
                    <div class="predictive-title">Predictive Threat Intelligence</div>
                    <button class="btn btn-secondary" id="update-analysis">
                        <i class="fas fa-sync"></i> Update Analysis
                    </button>
                </div>
                
                <div class="threat-indicators">
                    <div class="threat-indicator">
                        <div class="threat-value">78%</div>
                        <div class="threat-label">Overall Security Score</div>
                        <div class="threat-trend positive">‚Üë 5% from last week</div>
                    </div>
                    <div class="threat-indicator">
                        <div class="threat-value">12</div>
                        <div class="threat-label">Active Threats</div>
                        <div class="threat-trend negative">‚Üë 3 new threats</div>
                    </div>
                    <div class="threat-indicator">
                        <div class="threat-value">94%</div>
                        <div class="threat-label">Compliance Status</div>
                        <div class="threat-trend positive">‚Üë 2% improvement</div>
                    </div>
                    <div class="threat-indicator">
                        <div class="threat-value">3</div>
                        <div class="threat-label">High Priority Alerts</div>
                        <div class="threat-trend neutral">No change</div>
                    </div>
                </div>
            </div>
            
            <!-- NLP Analysis Display -->
            <div class="nlp-analysis">
                <div class="predictive-header">
                    <div class="predictive-title">Natural Language Processing Analysis</div>
                    <button class="btn btn-primary" id="analyze-text">
                        <i class="fas fa-code"></i> Analyze Text
                    </button>
                </div>
                
                <div class="analysis-result" id="nlp-result">
                    <div class="analysis-item">
                        <div class="analysis-label">Query Intent:</div>
                        <div class="analysis-value" id="intent-value">Security Inquiry</div>
                    </div>
                    <div class="analysis-item">
                        <div class="analysis-label">Confidence Score:</div>
                        <div class="analysis-value" id="confidence-value">92%</div>
                    </div>
                    <div class="analysis-item">
                        <div class="analysis-label">Entities Detected:</div>
                        <div class="analysis-value" id="entities-value">5 security-related terms</div>
                    </div>
                    <div class="analysis-item">
                        <div class="analysis-label">Sentiment Analysis:</div>
                        <div class="analysis-value" id="sentiment-value">Neutral</div>
                    </div>
                    <div class="analysis-item">
                        <div class="analysis-label">Response Time:</div>
                        <div class="analysis-value" id="response-time">0.8s</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced ZaraAI with NLP and Predictive Intelligence
        const enhancedZaraAI = {
            // NLP Processing Engine
            nlpProcessor: {
                analyzeText: function(text) {
                    const analysis = {
                        intent: this.detectIntent(text),
                        confidence: this.calculateConfidence(text),
                        entities: this.extractEntities(text),
                        sentiment: this.analyzeSentiment(text),
                        responseTime: (Math.random() * 0.5 + 0.5).toFixed(1) + 's'
                    };
                    return analysis;
                },
                
                detectIntent: function(text) {
                    const lowerText = text.toLowerCase();
                    if (lowerText.includes('risk') || lowerText.includes('security') || lowerText.includes('threat')) {
                        return 'Security Assessment';
                    } else if (lowerText.includes('compliance') || lowerText.includes('regulation') || lowerText.includes('policy')) {
                        return 'Compliance Inquiry';
                    } else if (lowerText.includes('train') || lowerText.includes('learn') || lowerText.includes('module')) {
                        return 'Training Request';
                    } else if (lowerText.includes('incident') || lowerText.includes('breach') || lowerText.includes('attack')) {
                        return 'Incident Response';
                    } else {
                        return 'General Inquiry';
                    }
                },
                
                calculateConfidence: function(text) {
                    // Simulate confidence calculation based on text complexity and keywords
                    const baseConfidence = 80;
                    const lengthBonus = Math.min(text.length * 0.5, 15);
                    const keywordBonus = this.countSecurityKeywords(text) * 3;
                    return Math.min(baseConfidence + lengthBonus + keywordBonus, 98) + '%';
                },
                
                countSecurityKeywords: function(text) {
                    const keywords = ['security', 'risk', 'threat', 'compliance', 'policy', 'incident', 'breach', 'attack', 'vulnerability', 'protection'];
                    const lowerText = text.toLowerCase();
                    return keywords.filter(keyword => lowerText.includes(keyword)).length;
                },
                
                extractEntities: function(text) {
                    const entities = [];
                    const securityTerms = ['phishing', 'malware', 'ransomware', 'firewall', 'encryption', 'authentication'];
                    const lowerText = text.toLowerCase();
                    
                    securityTerms.forEach(term => {
                        if (lowerText.includes(term)) {
                            entities.push(term);
                        }
                    });
                    
                    return entities.length > 0 ? entities.length + ' security entities' : 'No specific entities';
                },
                
                analyzeSentiment: function(text) {
                    const positiveWords = ['good', 'great', 'excellent', 'secure', 'protected', 'compliant', 'improved'];
                    const negativeWords = ['bad', 'poor', 'vulnerable', 'breach', 'attack', 'failed', 'weak'];
                    
                    let positiveCount = 0;
                    let negativeCount = 0;
                    
                    const words = text.toLowerCase().split(' ');
                    words.forEach(word => {
                        if (positiveWords.includes(word)) positiveCount++;
                        if (negativeWords.includes(word)) negativeCount++;
                    });
                    
                    if (positiveCount > negativeCount) return 'Positive';
                    if (negativeCount > positiveCount) return 'Negative';
                    return 'Neutral';
                }
            },
            
            // Predictive Intelligence Engine
            predictiveEngine: {
                assessRisk: function() {
                    return {
                        score: Math.floor(Math.random() * 20) + 75, // 75-95%
                        trend: Math.random() > 0.5 ? 'improving' : 'stable',
                        threats: Math.floor(Math.random() * 5) + 8, // 8-12
                        recommendations: this.generateRecommendations()
                    };
                },
                
                generateRecommendations: function() {
                    const recommendations = [
                        "Implement multi-factor authentication for all admin accounts",
                        "Schedule security awareness training for Q3",
                        "Update firewall rules to block suspicious IP ranges",
                        "Conduct vulnerability assessment for web applications",
                        "Review and update incident response plan",
                        "Enable advanced threat protection in email security",
                        "Implement data loss prevention policies for sensitive data"
                    ];
                    
                    // Return 2-3 random recommendations
                    const count = Math.floor(Math.random() * 2) + 2;
                    const shuffled = [...recommendations].sort(() => 0.5 - Math.random());
                    return shuffled.slice(0, count);
                },
                
                predictThreats: function() {
                    const potentialThreats = [
                        { type: "Phishing Campaign", probability: "High", impact: "Medium" },
                        { type: "Ransomware Attack", probability: "Medium", impact: "High" },
                        { type: "Data Breach", probability: "Low", impact: "High" },
                        { type: "DDoS Attack", probability: "Medium", impact: "Medium" }
                    ];
                    
                    // Filter to only include high/medium probability threats
                    return potentialThreats.filter(threat => 
                        threat.probability === "High" || threat.probability === "Medium"
                    );
                }
            },
            
            // Response Generator with Enhanced Intelligence
            generateResponse: function(userMessage, analysis) {
                const responses = {
                    'Security Assessment': [
                        `Based on my analysis of your security posture, I've identified ${Math.floor(Math.random() * 5) + 3} key areas for improvement. Your current risk score is ${Math.floor(Math.random() * 20) + 75}%, which is ${Math.random() > 0.5 ? 'above' : 'below'} industry average.`,
                        `I've assessed your security controls and found ${Math.floor(Math.random() * 3) + 1} critical vulnerabilities that require immediate attention. Let me provide specific recommendations.`,
                        `Your security posture shows strengths in ${['access controls', 'network security', 'data protection'][Math.floor(Math.random() * 3)]} but needs improvement in ${['incident response', 'user training', 'patch management'][Math.floor(Math.random() * 3)]}.`
                    ],
                    'Compliance Inquiry': [
                        `I've analyzed your compliance status against ${['GDPR', 'HIPAA', 'PCI-DSS', 'SOX'][Math.floor(Math.random() * 4)]} requirements. You're ${Math.floor(Math.random() * 20) + 80}% compliant with ${Math.floor(Math.random() * 3) + 1} areas needing attention.`,
                        `Based on your compliance framework, I've identified ${Math.floor(Math.random() * 4) + 1} controls that require updates to meet regulatory requirements.`,
                        `Your compliance posture is strong, but I recommend reviewing your ${['data retention policies', 'access logging', 'third-party risk management'][Math.floor(Math.random() * 3)]} to maintain compliance.`
                    ],
                    'Training Request': [
                        `I recommend focusing your training on ${['phishing awareness', 'social engineering', 'password security', 'data handling'][Math.floor(Math.random() * 4)]} based on current threat intelligence.`,
                        `Your team would benefit from advanced training in ${['incident response', 'cloud security', 'mobile device security'][Math.floor(Math.random() * 3)]}. I can generate a customized training plan.`,
                        `Based on recent security incidents in your industry, I suggest prioritizing training for ${Math.floor(Math.random() * 3) + 1} key security domains.`
                    ],
                    'Incident Response': [
                        `For the security incident you described, I recommend following these ${Math.floor(Math.random() * 3) + 3} immediate steps to contain and mitigate the impact.`,
                        `Based on incident response best practices, you should prioritize ${['containment', 'eradication', 'recovery'][Math.floor(Math.random() * 3)]} activities first.`,
                        `I've analyzed similar incidents and recommend these ${Math.floor(Math.random() * 4) + 2} actions to resolve the current situation effectively.`
                    ],
                    'General Inquiry': [
                        `I've processed your query using advanced NLP and can provide insights based on current security intelligence and best practices.`,
                        `As your AI security assistant, I can help with risk assessment, compliance guidance, threat intelligence, and security training recommendations.`,
                        `I understand you're looking for security information. Let me provide you with actionable insights based on your specific context.`
                    ]
                };
                
                const intentResponses = responses[analysis.intent] || responses['General Inquiry'];
                return intentResponses[Math.floor(Math.random() * intentResponses.length)];
            }
        };

        // DOM Elements
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const voiceBtn = document.getElementById('voice-btn');
        const analyzeBtn = document.getElementById('analyze-btn');
        const analyzeTextBtn = document.getElementById('analyze-text');
        const refreshAiBtn = document.getElementById('refresh-ai');
        const updateAnalysisBtn = document.getElementById('update-analysis');

        // Voice Recognition
        let recognition = null;
        let isListening = false;

        // Initialize voice recognition if available
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                userInput.value = transcript;
                processUserMessage(transcript);
                voiceBtn.classList.remove('voice-listening');
                isListening = false;
            };

            recognition.onerror = function(event) {
                console.error('Speech recognition error', event.error);
                voiceBtn.classList.remove('voice-listening');
                isListening = false;
                addMessage("Sorry, I couldn't understand your voice command. Please try again or type your message.", false);
            };

            recognition.onend = function() {
                voiceBtn.classList.remove('voice-listening');
                isListening = false;
            };
        }

        // Function to add message to chat
        function addMessage(message, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-enhanced ${isUser ? 'user' : 'zara'}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content-enhanced';
            contentDiv.innerHTML = message;
            
            messageDiv.appendChild(contentDiv);
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Function to process user message with NLP
        function processUserMessage(message) {
            if (!message.trim()) return;

            // Add user message to chat
            addMessage(message, true);

            // Show typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'message-enhanced zara';
            typingIndicator.innerHTML = '<div class="message-content-enhanced"><i class="fas fa-circle-notch fa-spin"></i> Analyzing with NLP...</div>';
            chatMessages.appendChild(typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Simulate NLP processing delay
            setTimeout(() => {
                // Remove typing indicator
                chatMessages.removeChild(typingIndicator);
                
                // Perform NLP analysis
                const analysis = enhancedZaraAI.nlpProcessor.analyzeText(message);
                
                // Update NLP analysis display
                document.getElementById('intent-value').textContent = analysis.intent;
                document.getElementById('confidence-value').textContent = analysis.confidence;
                document.getElementById('entities-value').textContent = analysis.entities;
                document.getElementById('sentiment-value').textContent = analysis.sentiment;
                document.getElementById('response-time').textContent = analysis.responseTime;
                
                // Generate and display response
                const response = enhancedZaraAI.generateResponse(message, analysis);
                addMessage(response);
                
                // Add predictive insights for security-related queries
                if (analysis.intent === 'Security Assessment' || analysis.intent === 'Threat Analysis') {
                    setTimeout(() => {
                        const threats = enhancedZaraAI.predictiveEngine.predictThreats();
                        let threatMessage = `<strong>Predictive Threat Intelligence:</strong><br>`;
                        threatMessage += `I've identified ${threats.length} potential threats:<br><br>`;
                        
                        threats.forEach(threat => {
                            threatMessage += `‚Ä¢ <strong>${threat.type}</strong> (Probability: ${threat.probability}, Impact: ${threat.impact})<br>`;
                        });
                        
                        threatMessage += `<br><em>Based on current threat intelligence and historical patterns</em>`;
                        addMessage(threatMessage);
                    }, 1000);
                }
                
                // Add recommendations for compliance queries
                if (analysis.intent === 'Compliance Inquiry') {
                    setTimeout(() => {
                        const riskAssessment = enhancedZaraAI.predictiveEngine.assessRisk();
                        let complianceMessage = `<strong>Compliance Recommendations:</strong><br>`;
                        complianceMessage += `Your compliance risk score: <strong>${riskAssessment.score}%</strong><br><br>`;
                        complianceMessage += `Key recommendations:<br>`;
                        
                        riskAssessment.recommendations.forEach(rec => {
                            complianceMessage += `‚Ä¢ ${rec}<br>`;
                        });
                        
                        addMessage(complianceMessage);
                    }, 1000);
                }

            }, 1500);
        }

        // Quick Action Functions
        function quickAction(action) {
            const actions = {
                risk_assessment: "Perform a comprehensive security risk assessment",
                threat_analysis: "Analyze current threat landscape and predict potential security threats",
                compliance_check: "Check compliance status against major regulatory frameworks"
            };

            userInput.value = actions[action];
            processUserMessage(actions[action]);
        }

        // Analyze text function
        function analyzeText() {
            const text = userInput.value.trim();
            if (!text) {
                alert("Please enter some text to analyze");
                return;
            }

            const analysis = enhancedZaraAI.nlpProcessor.analyzeText(text);
            
            // Update NLP analysis display
            document.getElementById('intent-value').textContent = analysis.intent;
            document.getElementById('confidence-value').textContent = analysis.confidence;
            document.getElementById('entities-value').textContent = analysis.entities;
            document.getElementById('sentiment-value').textContent = analysis.sentiment;
            document.getElementById('response-time').textContent = analysis.responseTime;

            // Show analysis results in chat
            addMessage(`<strong>Text Analysis Results:</strong><br>
                ‚Ä¢ <strong>Intent:</strong> ${analysis.intent}<br>
                ‚Ä¢ <strong>Confidence:</strong> ${analysis.confidence}<br>
                ‚Ä¢ <strong>Entities:</strong> ${analysis.entities}<br>
                ‚Ä¢ <strong>Sentiment:</strong> ${analysis.sentiment}<br>
                ‚Ä¢ <strong>Processing Time:</strong> ${analysis.responseTime}`, false);
        }

        // Toggle voice recognition
        function toggleVoiceRecognition() {
            if (!recognition) {
                addMessage("Voice recognition is not supported in your browser. Please use text input.", false);
                return;
            }

            if (isListening) {
                recognition.stop();
                voiceBtn.classList.remove('voice-listening');
                isListening = false;
            } else {
                recognition.start();
                voiceBtn.classList.add('voice-listening');
                isListening = true;
                addMessage("Listening... Please speak now.", false);
            }
        }

        // Update threat analysis
        function updateThreatAnalysis() {
            const riskAssessment = enhancedZaraAI.predictiveEngine.assessRisk();
            const threats = enhancedZaraAI.predictiveEngine.predictThreats();
            
            // Update threat indicators
            document.querySelector('.threat-indicator:nth-child(1) .threat-value').textContent = `${riskAssessment.score}%`;
            document.querySelector('.threat-indicator:nth-child(2) .threat-value').textContent = threats.length;
            document.querySelector('.threat-indicator:nth-child(3) .threat-value').textContent = `${riskAssessment.score + 5}%`;
            document.querySelector('.threat-indicator:nth-child(4) .threat-value').textContent = Math.floor(Math.random() * 3) + 1;

            // Show update confirmation
            addMessage("Threat intelligence updated with latest predictive analysis and risk assessment data.", false);
        }

        // Refresh AI function
        function refreshAI() {
            addMessage("AI models refreshed and updated with latest security intelligence data. All systems operational.", false);
            
            // Simulate AI refresh
            setTimeout(() => {
                document.querySelectorAll('.status-dot').forEach(dot => {
                    dot.className = 'status-dot status-active';
                });
            }, 500);
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Send message on button click
            sendBtn.addEventListener('click', function() {
                const message = userInput.value.trim();
                processUserMessage(message);
                userInput.value = '';
            });

            // Send message on Enter key
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const message = userInput.value.trim();
                    processUserMessage(message);
                    userInput.value = '';
                }
            });

            // Voice recognition
            voiceBtn.addEventListener('click', toggleVoiceRecognition);

            // Analyze text
            analyzeBtn.addEventListener('click', analyzeText);

            // Analyze text button
            analyzeTextBtn.addEventListener('click', analyzeText);

            // Update threat analysis
            updateAnalysisBtn.addEventListener('click', updateThreatAnalysis);

            // Refresh AI
            refreshAiBtn.addEventListener('click', refreshAI);

            // Initialize with a welcome analysis
            const welcomeAnalysis = enhancedZaraAI.nlpProcessor.analyzeText("security risk assessment");
            document.getElementById('intent-value').textContent = welcomeAnalysis.intent;
            document.getElementById('confidence-value').textContent = welcomeAnalysis.confidence;
            document.getElementById('entities-value').textContent = welcomeAnalysis.entities;
            document.getElementById('sentiment-value').textContent = welcomeAnalysis.sentiment;
        });

        // Service Worker Registration for PWA (commented for demo)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // In production, this would register the service worker
                console.log('PWA Service Worker would be registered here');
            });
        }
    </script>
</body>
</html>